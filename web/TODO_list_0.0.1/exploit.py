import requests
import json

def share_todo_api(todo, token, base_url='http://host1.dreamhack.games:10119'):
    """
    shareTodo API에 Todo 항목을 공유하는 함수.

    :param todo: 공유할 Todo 항목을 포함한 딕셔너리.
    :param token: 인증에 사용할 JWT 토큰.
    :param base_url: API의 기본 URL. 기본값은 'https://yourapi.com'.
    :return: 서버의 응답 객체.
    """
    url = f"{base_url}/api/shareTodo"
    headers = {
        'Content-Type': 'application/json',
        'Authorization': f'Bearer {token}'
    }

    try:
        payload = json.dumps(todo)
        
        response = requests.post(url, headers=headers, data=payload)
        
        if response.status_code == 200:
            print("Todo가 성공적으로 공유되었습니다.")
            return response.json()
        else:
            print(f"실패: 상태 코드 {response.status_code}")
            print(f"응답 내용: {response.text}")
            response.raise_for_status()
    
    except requests.exceptions.RequestException as e:
        print(f"요청 중 오류 발생: {e}")
        return None

def update_api(update, token, base_url):
	url = f"{base_url}/api/updateTodo"

	data = json.dumps(update)
	
	headers = {
		"Content-Type": "application/json",
		"Authorization": f"Bearer {token}"
	}	

	response = requests.post(url, headers=headers, data=data)

	print(response.text)

if __name__ == "__main__":
    todo_item = {
        "id": 1,
	"target_id": 2,
        "title": "test",
        "description": "test",
	"is_completed": 0,
        "start_date": "2025-05-01",
	"due_date": "2025-05-02"
    }
    
    jwt_token = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOjIsImVtYWlsIjoiemFtYmJvQGV4YW1sZS5jb20iLCJpYXQiOjE3MzgwMjc3NzcsImV4cCI6MTczODAzODU3N30.ZqErODgNRbbDg-XxpaKAhq1jgnyPpXpbEfp1bOr4TcY"
    
    base_url = "http://host1.dreamhack.games:10119"

    update_item = {
        "id": 1,
        "value": 0
    }
    update_api(update_item, jwt_token, base_url)
    result = share_todo_api(todo_item, jwt_token, base_url)

    if result:
        print("서버 응답:", result)

